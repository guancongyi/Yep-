{"code":"!function(e){var t={};function r(o){if(t[o])return t[o].exports;var l=t[o]={i:o,l:!1,exports:{}};return e[o].call(l.exports,l,l.exports,r),l.l=!0,l.exports}r.m=e,r.c=t,r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},r.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var l in e)r.d(o,l,function(t){return e[t]}.bind(null,l));return o},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,\"a\",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p=\"\",r(r.s=0)}([function(e,t,r){\"use strict\";r.r(t);var o=class{constructor(){firebase.initializeApp({apiKey:\"AIzaSyBxAY8l3CubPoeLoRNaNnYC5zYfgX2aDp0\",authDomain:\"inf551-d972f.firebaseapp.com\",databaseURL:\"https://inf551-d972f.firebaseio.com\",projectId:\"inf551-d972f\",storageBucket:\"inf551-d972f.appspot.com\",messagingSenderId:\"1023654183370\",appId:\"1:1023654183370:web:df412475f62dce4e560f33\"}),this.currDB=\"world\"}getData(e,t=null,r=100){let o=firebase.database().ref();if(null==t){let t=o.child(e).limitToFirst(r);return new Promise((e,r)=>{t.on(\"value\",(function(t){e(Object.values(t.val()))}))})}if(\"world\"==e){let e=o.child(\"world_index\").orderByKey().equalTo(t.keyword).limitToFirst(r);return new Promise((function(t,r){e.on(\"value\",(function(e){console.log(e.val());let r=Object.values(e.val())[0],o={country2:[],city:[],countrylanguage:[]};for(let e=0;e<r.length;e++){o[r[e][0]].push(r[e][2])}t(o)}))}))}if(\"us_restaurant\"==e){let e=o.child(\"yelp_index\").orderByKey().equalTo(t.keyword).limitToFirst(r);return new Promise((function(t,r){e.on(\"value\",(function(e){let r=Object.values(e.val())[0],o={yelp_business:[],yelp_user:[]};for(let e=0;e<r.length;e++){o[r[e][0]].push(r[e][2])}t(o)}))}))}}getDataByKey(e,t){}};var l=class{constructor(e){this.domId=\"#\"+e,this.map=new ol.Map({target:e,layers:[new ol.layer.Tile({source:new ol.source.OSM})],view:new ol.View({center:ol.proj.fromLonLat([-118.286324,34.020318]),zoom:8})})}addMarker(e,t,r){t=parseFloat(t),r=parseFloat(r);let o=new ol.Feature({geometry:new ol.geom.Point(ol.proj.fromLonLat([t,r]))});this.map.addLayer(new ol.layer.Vector({source:new ol.source.Vector({features:[o]}),style:new ol.style.Style({image:new ol.style.Circle({radius:6,stroke:new ol.style.Stroke({color:\"#fff\"}),fill:new ol.style.Fill({color:\"red\"})})})})),this.map.getView().setZoom(1)}showMap(){$(this.domId).css(\"display\",\"block\")}clearMap(){$(this.domId).css(\"display\",\"none\")}};let n=new o,i=new l(\"map\"),a=\"world\";function s(e,t){let r=Object.keys(t[0]);$(e).children(\"#tb_header\").empty();let o=\"<tr>\";for(let e=0;e<r.length;e++)o+=\"<th>\"+r[e]+\"</th>\";o+=\"</tr>\",$(e).children(\"#tb_header\").append(o),$(e).children(\"#tb_body\").empty();for(let r=0;r<t.length;r++){let l=Object.values(t[r]);o=\"<tr>\";for(let e=0;e<l.length;e++)o+=\"<td>\"+l[e]+\"</td>\";o+=\"</tr>\",$(e).children(\"#tb_body\").append(o)}!function(e){$(e).css(\"display\",\"block\")}(e)}$(\"#t1\").children(\"#tb_header\").empty(),$(\"#t1\").children(\"#tb_body\").empty(),$(\"#t2\").children(\"#tb_header\").empty(),$(\"#t2\").children(\"#tb_body\").empty(),$(\"#t3\").children(\"#tb_header\").empty(),$(\"#t3\").children(\"#tb_body\").empty(),$(\"#t1\").css(\"display\",\"None\"),$(\"#t2\").css(\"display\",\"None\"),$(\"#t3\").css(\"display\",\"None\"),$(\"table\").on(\"scroll\",(function(){$(\"#\"+this.id+\" > *\").width($(this).width()+$(this).scrollLeft())})),$(\"#submit\").click((function(){!function(){if(\"world\"==a){let e=$(\"#keyword\").val();n.getData(a,{keyword:e}).then(e=>{let t=Object.values(e);for(let e=0;e<3;e++)0!=t[e].length&&s(\"#t\"+(e+1),t[e])})}else if(\"us_restaurant\"==a){let e=$(\"#keyword\").val();n.getData(a,{keyword:e}).then(e=>{let t=Object.values(e);for(let e=0;e<2;e++){if(0==t[e].length)continue;if(0==e)for(let r=0;r<t[e].length;r++)i.addMarker(\"\",t[e][r].longitude,t[e][r].latitude);let r=\"#t\"+(e+1);console.log(t[e]),s(r,t[e])}})}}()})),$(\"#select_db input\").on(\"change\",(function(){a=$(\"input[name=db]:checked\",\"#select_db\").val(),\"world\"==a?(i.clearMap(),$(\"#filter_options\").empty(),$(\"#filter_options\").append(\"<p>Keyword Search: </p>\"),$(\"#filter_options\").append('<input id=\"keyword\" placeholder=\"Enter keywords here\"></input>'),n.getData(\"country\",null).then(e=>{s(\"#t1\",e)})):\"world_restaurant\"==a?(i.clearMap(),$(\"#filter_options\").empty(),$(\"#filter_options\").append(\"<h1>World Restaurant Filters</h1>\"),$(\"#filter_options\").append(\"<h1>World Restaurant Filters</h1>\"),$(\"#filter_options\").append(\"<h1>World Restaurant Filters</h1>\"),$(\"#filter_options\").append(\"<h1>World Restaurant Filters</h1>\")):($(\"#filter_options\").empty(),$(\"#filter_options\").append(\"<p>Keyword Search: </p>\"),$(\"#filter_options\").append('<input id=\"keyword\" placeholder=\"Enter keywords here\"></input>'),i.showMap(),n.getData(\"yelp_business\",null).then(e=>{s(\"#t1\",e)}))}))}]);","extractedComments":[]}